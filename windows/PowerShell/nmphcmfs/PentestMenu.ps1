function Get-SampleUsage {
    param(
        [string]$SiteName,
        [string]$SampleCommand
    )
    switch ($SiteName) {
        "Shodan" {
            return "Bu komut, Shodan üzerinde 'Example Corp' organizasyonuna ait cihazları port 443 üzerinden arayan bir sorgudur. Terminalinize yapıştırdığınızda, hedef organizasyona ait internet servislerini ve cihaz bilgilerini listeleyebilirsiniz."
        }
        "Wigle" {
            return "Bu komut, Wigle veritabanında 'MyHomeNetwork' SSID'sine sahip Wi-Fi erişim noktalarını arar. Böylece, ağın konum bilgileri, sinyal gücü ve diğer detayları elde edebilirsiniz."
        }
        "Grep.app" {
            return "Bu komut, grep.app üzerinde 'function mySecretFunc' ifadesini arayarak, kod depolarında ilgili fonksiyonun geçtiği yerleri listeler. Böylece, potansiyel güvenlik açığı barındıran kod parçalarını tespit edebilirsiniz."
        }
        "BinaryEdge" {
            return "Bu komut, BinaryEdge üzerinde 'example.com' domainine ait, port 445 üzerinden çalışan servisleri arar. Böylece, hedef sistemin hangi servisleri sunduğunu ve varsa açıklarını görebilirsiniz."
        }
        "Onyphe" {
            return "Bu komut, Onyphe API'si ile 'example.com' domainine ait bilgileri getirir; ayrıca IP 1.2.3.4 üzerinde aktif servisleri ve zafiyet bilgilerini incelemenizi sağlar."
        }
        "GreyNoise" {
            return "Bu komut, GreyNoise üzerinde belirli bir IP adresi için tarama yapar. Böylece, o IP’nin geçmişteki saldırı girişimleri, botnet aktiviteleri gibi bilgileri analiz edebilirsiniz."
        }
        "Censys" {
            return "Bu komut, Censys veritabanında 'Istanbul' şehrinde yer alan HTTPS servislerini arar. Bu sayede, bölgedeki açık portları, sertifika bilgilerini ve sistem yapılandırmalarını inceleyebilirsiniz."
        }
        "Sterra" {
            return "Bu komut, Sterra ile 'user@example.com' e-posta adresi üzerinden sızma testlerine yönelik bilgileri kontrol eder. E-posta sızıntısı veya phishing durumlarını tespit etmek için kullanılabilir."
        }
        "Hofa" {
            return "Bu komut, Hofa üzerinde 'example.com' domainine ait IP ve port bilgilerini analiz eder. Böylece, hedef ağın yapılandırması, açık portları ve olası güvenlik açıklarını görebilirsiniz."
        }
        "Zoomeye" {
            return "Bu komut, Zoomeye üzerinde 'index of' ifadesini arayarak, açık dizin ve dosya yapılandırmalarını tespit eder. Terminalinize yapıştırdığınızda, potansiyel olarak hassas dosyaların listesini elde edebilirsiniz."
        }
        "LeakIX" {
            return "Bu komut, LeakIX üzerinde 'db_users' indeksinde veri sızıntısı olup olmadığını kontrol eder. Böylece, hedef sistemdeki hassas bilgilerin açığa çıkıp çıkmadığını görebilirsiniz."
        }
        "Netlas" {
            return "Bu komut, Netlas ile 'example.com' domaini üzerinde FTP servisini arar. Hedefin saldırı yüzeyini analiz etmek ve potansiyel zafiyetleri belirlemek için kullanılabilir."
        }
        "Searchcode" {
            return "Bu komut, Searchcode üzerinde 'config.php' dosyasını arayarak, projelerdeki konfigürasyon dosyalarını ve potansiyel güvenlik açıklarını tespit eder. Böylece, kaynak kod içinde gizli bilgileri bulabilirsiniz."
        }
        "urlscan" {
            return "Bu komut, urlscan ile belirli bir URL üzerinden web sitesinin taramasını başlatır. Çalıştırdığınızda, HTTP istek/yanıt detaylarını ve site üzerindeki olası zafiyetleri görüntüleyebilirsiniz."
        }
        "PublicWWW" {
            return "Bu komut, PublicWWW üzerinde 'Divi' teması arayarak, WordPress sitelerindeki kullanılan temaları ve ilgili yapılandırmaları inceler. Böylece, hedef sitenin teknolojik altyapısına dair ipuçları elde edebilirsiniz."
        }
        "FullHunt" {
            return "Bu komut, FullHunt üzerinde 'example.com' alt domainlerini tarar. Böylece, hedefin internet üzerindeki tüm varlıklarını keşfedebilir ve potansiyel güvenlik açıklarını belirleyebilirsiniz."
        }
        "S0cradar" {
            return "Bu komut, S0cradar ile 'example.com' alan adını kontrol ederek, marka ihlalleri, sızıntılar ve diğer riskleri tespit etmenizi sağlar. Terminal çıktıları üzerinden detaylı analiz yapabilirsiniz."
        }
        "IVRE" {
            return "Bu komut, IVRE ile Nmap tarama çıktısını analiz eder. Örneğin, '-sV -O' parametreleri kullanılarak sistemin işletim sistemi, servis versiyonları ve diğer detaylar belirlenir. Çıktı üzerinden hedef hakkında kapsamlı bilgi edinebilirsiniz."
        }
        "crt.sh" {
            return "Bu komut, crt.sh üzerinden 'example.com' domaininin SSL sertifikalarını sorgular. Böylece, alt domain bilgileri, sertifika geçerlilik tarihleri ve diğer ilgili verileri elde edebilirsiniz."
        }
        "Pulsedive" {
            return "Bu komut, Pulsedive ile IOC (Indicator of Compromise) araması yapar. Çalıştırdığınızda, zararlı örüntüler, risk skorları ve diğer sızma testi göstergelerini terminalde görebilirsiniz."
        }
        default {
            return "Bu komutu terminalinize yapıştırarak çalıştırabilirsiniz. Komut, seçilen servise özel arama kriterlerini içerir."
        }
    }
}

function PentestMenu {
    # Site bilgilerini, açıklamaları ve en az 10 adet komut örneğini tanımlıyoruz.
    $SearchEngines = @(
        @{
            Name = "Shodan"
            URL  = "https://www.shodan.io"
            Desc = "İnternete açık cihazları (server, IoT vb.) aramak için kullanılır."
            Commands = @(
                'org:"Example Corp" port:443',
                'country:"TR" "Apache httpd"',
                'ssl.cert.issuer.cn:"Let''s Encrypt"',
                'vuln:"Heartbleed"',
                'product:"nginx"',
                'port:22 country:"US"',
                'os:"Linux"',
                'city:"Istanbul"',
                'net:"192.168.0.0/16"',
                'title:"Dashboard"'
            )
        },
        @{
            Name = "Wigle"
            URL  = "https://wigle.net"
            Desc = "Wi-Fi erişim noktalarını ve konumlarını harita üzerinde gösterir."
            Commands = @(
                'SSID araması: SSID="MyHomeNetwork"',
                'BSSID araması: BSSID="00:11:22:33:44:55"',
                'City araması: city:"Istanbul"',
                'Country araması: country:"TR"',
                'Signal Gücü: signal:>-50',
                'Güvenlik Tipi: security:"WPA2"',
                'Frekans: freq:"2.4GHz"',
                'Kanal: channel:"6"',
                'MAC araması: mac:"00:11:22:33:44:55"',
                'Envanter: list:all'
            )
        },
        @{
            Name = "Grep.app"
            URL  = "https://grep.app"
            Desc = "Büyük kod depolarında metin/kod araması yapar."
            Commands = @(
                '"password" extension:js',
                '"api_key" extension:py',
                'function araması: "function mySecretFunc"',
                'config araması: "config"',
                'debug araması: "console.log"',
                'error araması: "Exception"',
                'version araması: "v1.0.0"',
                'token araması: "Bearer "',
                'secret araması: "SECRET_KEY"',
                'database bağlantısı: "Data Source="'
            )
        },
        @{
            Name = "BinaryEdge"
            URL  = "https://app.binaryedge.com"
            Desc = "İnternete açık varlıklar (IP, domain vb.) ve tehdit istihbaratı."
            Commands = @(
                'ip:"1.2.3.4"',
                'domain:"example.com"',
                'port:445 country:"TR"',
                'asn:"AS12345"',
                'service:"SSH"',
                'banner:"OpenSSH"',
                'os:"Windows"',
                'product:"IIS"',
                'vulnerability:"CVE-2021-1234"',
                'protocol:"HTTPS"'
            )
        },
        @{
            Name = "Onyphe"
            URL  = "https://www.onyphe.io"
            Desc = "IP ve domain bazlı pasif bilgi toplama, tehdit istihbaratı."
            Commands = @(
                'ip:1.2.3.4',
                'domain:example.com',
                'Osint araması: tag:"malware"',
                'port:80,443',
                'protocol:"HTTP"',
                'filter:"recent"',
                'vulnerability:"CVE-2020-5678"',
                'organization:"Example Inc."',
                'country:"US"',
                'network:"10.0.0.0/8"'
            )
        },
        @{
            Name = "GreyNoise"
            URL  = "https://viz.greynoise.io"
            Desc = "IP adreslerinin zararlı/saldırgan aktivitesini analiz eder."
            Commands = @(
                'IP sorgusu: 1.2.3.4',
                'noise filtreleme: type:"scanner"',
                'botnet araması',
                'ülke bazlı sorgu: country:"DE"',
                'port taraması: port:80',
                'protokol filtre: protocol:"TCP"',
                'geçmiş olaylar: history:true',
                'zararlı etiket: tag:"malicious"',
                'istatistik: stats:true',
                'cihaz türü: device:"router"'
            )
        },
        @{
            Name = "Censys"
            URL  = "https://censys.io"
            Desc = "SSL sertifikaları, IP ve domain taramaları için arama motoru."
            Commands = @(
                'services.service_name:HTTP AND location.country_code:TR',
                'parsed.names:*.example.com',
                '443.https.tls.version:TLS1.2',
                'location.city:"Istanbul"',
                'protocol:"HTTPS"',
                'certificate.expired:true',
                'os:"Linux"',
                'vulnerability:"CVE-2019-0708"',
                'port:443',
                'banner:"Apache"'
            )
        },
        @{
            Name = "Sterra"
            URL  = "https://sterra.com"
            Desc = "E-posta adresi üzerinden arama ve ek istihbarat fonksiyonları."
            Commands = @(
                'E-posta sorgusu: user@example.com',
                'Domain araması: @example.com',
                'Email leak kontrolü',
                'Phishing tespiti: "suspicious"',
                'SMTP banner sorgusu',
                'MX kayıt araması',
                'SPF kontrolü',
                'DKIM sorgusu',
                'IP sorgusu: 1.2.3.4',
                'Blacklist kontrolü'
            )
        },
        @{
            Name = "Hofa"
            URL  = "https://hofa.info"
            Desc = "Tehdit istihbaratı, IP/domain analizi."
            Commands = @(
                'IP sorgusu: 1.2.3.4',
                'domain:example.com',
                'port:80,443',
                'geolocation: Istanbul',
                'ASN araması: AS1234',
                'protocol:"HTTP"',
                'vulnerability:"CVE-2018-1234"',
                'banner kontrolü',
                'SSL durum kontrolü',
                'log analizi'
            )
        },
        @{
            Name = "Zoomeye"
            URL  = "https://www.zoomeye.io"
            Desc = "Shodan benzeri cihaz arama motoru, özellikle Asya merkezli veriler."
            Commands = @(
                'app:"Apache httpd"',
                'country:"CN" port:22',
                'title:"index of"',
                'os:"Linux"',
                'device:"router"',
                'version:"1.0"',
                'protocol:"SSH"',
                'service:"Telnet"',
                'location:"Beijing"',
                'vulnerability:"CVE-2020-9999"'
            )
        },
        @{
            Name = "LeakIX"
            URL  = "https://leakix.net"
            Desc = "Açıklar, yanlış konfigürasyonlar ve veri sızıntıları için arama."
            Commands = @(
                'domain:example.com',
                'port:9200 (Elasticsearch sızıntıları)',
                'index:"db_users"',
                'os:"Linux"',
                'banner:"Elasticsearch"',
                'vulnerability:"CVE-2021-0001"',
                'cluster:"production"',
                'node:"node1"',
                'status:"open"',
                'protocol:"HTTP"'
            )
        },
        @{
            Name = "Netlas"
            URL  = "https://app.netlas.io"
            Desc = "OSINT ve saldırı yüzeyi keşfi için IP/domain aramaları."
            Commands = @(
                'domain:example.com',
                'ip:1.2.3.4',
                'country:"TR" port:21',
                'subdomain:*.example.com',
                'protocol:"FTP"',
                'vulnerability:"CVE-2017-1234"',
                'service:"Telnet"',
                'asn:"AS6789"',
                'network:"172.16.0.0/12"',
                'banner:"FileZilla"'
            )
        },
        @{
            Name = "Searchcode"
            URL  = "https://searchcode.com"
            Desc = "Kod parçacıkları, fonksiyon isimleri vb. için arama."
            Commands = @(
                'function mySecretFunction',
                'API_KEY =',
                'Filename araması: config.php',
                'debug: "console.log"',
                'error: "Exception"',
                'version: "v2.0"',
                'token: "Bearer"',
                'secret: "SECRET_KEY"',
                'config: "db_config"',
                'init: "initialize()"'
            )
        },
        @{
            Name = "urlscan"
            URL  = "https://urlscan.io"
            Desc = "Web site tarama, istek/response analizi, phishing tespiti."
            Commands = @(
                'URL girerek tarama başlatma',
                'phishing şüphesi: "suspicious"',
                'IP analizi: 1.2.3.4',
                'headers kontrolü',
                'HTTP metod: GET',
                'HTTP metod: POST',
                'response kodu: 200',
                'timeout ayarı: 30s',
                'proxy kullanımı',
                'user-agent değişimi'
            )
        },
        @{
            Name = "PublicWWW"
            URL  = "https://publicwww.com"
            Desc = "Web sitelerinin kaynak kodunda metin/kod araması."
            Commands = @(
                '"Powered by WordPress"',
                '"theme":"Divi" site:.tr',
                'Google Analytics ID araması: "UA-XXXXX"',
                'footer metni arama',
                'meta tag arama',
                'script arama',
                'CSS dosyası arama',
                'HTML5 etiket arama',
                'örnek: "bootstrap"',
                'örnek: "jquery"'
            )
        },
        @{
            Name = "FullHunt"
            URL  = "https://fullhunt.io"
            Desc = "Saldırı yüzeyi analizi, zafiyet tarama platformu."
            Commands = @(
                'Subdomain keşfi: example.com',
                'Otomatik zafiyet raporlaması',
                'IP ve port bazlı zafiyet araması',
                'banner analizi',
                'servis taraması',
                'port aralığı: 20-80',
                'CIDR araması: 192.168.0.0/24',
                'vulnerability check',
                'protocol:"TCP"',
                'geolocation: "Ankara"'
            )
        },
        @{
            Name = "S0cradar"
            URL  = "https://s0cradar.io"
            Desc = "Tehdit istihbaratı, saldırı yüzeyi yönetimi, marka koruma."
            Commands = @(
                'Marka izleme: example.com',
                'Sızıntı kaynakları takibi',
                'Phishing uyarısı',
                'domain blacklist kontrolü',
                'IP sorgusu: 1.2.3.4',
                'log analizi',
                'vulnerability taraması',
                'port taraması',
                'user agent analizi',
                'proxy listesi'
            )
        },
        @{
            Name = "IVRE"
            URL  = "https://ivre.rocks"
            Desc = "Nmap sonuçlarını depolama, görselleştirme ve analiz aracı."
            Commands = @(
                'Nmap çıktısı: -sV -O',
                'IVRE''ye veri ekleme',
                'grafiksel analiz',
                'coğrafi harita sorgusu',
                'port filtreleme: port:443',
                'dosya içi arama',
                'rapor oluşturma',
                'veritabanı sorgusu',
                'şüpheli IP araması',
                'log dosyası inceleme'
            )
        },
        @{
            Name = "crt.sh"
            URL  = "https://crt.sh"
            Desc = "SSL sertifikaları üzerinden subdomain ve domain keşfi."
            Commands = @(
                'example.com',
                'Sertifika seri numarası sorgusu',
                'subdomain bulma',
                'geçmiş sertifikalar',
                'domain wildcard arama',
                'expiry date kontrolü',
                'issuer bilgisi',
                'organization arama',
                'country kodu sorgusu',
                'port:443 kontrolü'
            )
        },
        @{
            Name = "Pulsedive"
            URL  = "https://pulsedive.com"
            Desc = "Tehdit istihbaratı, IOC (Indicator of Compromise) aramaları."
            Commands = @(
                'IP, Domain, URL bazlı IOC sorgusu',
                'Malware/Phishing filtrelemesi',
                'risk skoru görüntüleme',
                'vulnerability check',
                'tag araması: "malware"',
                'indicator listesi',
                'alert ayarları',
                'log analizi',
                'IP blacklist sorgusu',
                'coğrafi konum analizi'
            )
        }
    )
    
    # fzf ile sadece 'Name' alanlarını listeliyoruz.
    $selectedName = $SearchEngines | ForEach-Object { $_.Name } | fzf
    if (-not $selectedName) {
        Write-Host "Seçim yapılmadı. Çıkış yapılıyor..." -ForegroundColor Red
        return
    }
    
    # Seçilen siteyi bulup bilgileri gösteriyoruz.
    $site = $SearchEngines | Where-Object { $_.Name -eq $selectedName }
    if ($site) {
        Write-Host "=======================" -ForegroundColor Cyan
        Write-Host " Name : $($site.Name)" -ForegroundColor Cyan
        Write-Host " URL  : $($site.URL)" -ForegroundColor Cyan
        Write-Host " Desc : $($site.Desc)" -ForegroundColor Cyan
        Write-Host "=======================" -ForegroundColor Cyan
        
        if ($site.Commands) {
            Write-Host "`nKomutlar:" -ForegroundColor Magenta
            foreach ($cmd in $site.Commands) {
                Write-Host "  - $cmd" -ForegroundColor Magenta
            }
        }
        
        if ($site.Commands -and $site.Commands.Count -gt 0) {
            $sampleCommand = $site.Commands[0]
            $detailedUsage = Get-SampleUsage -SiteName $site.Name -SampleCommand $sampleCommand
            Write-Host "`nÖrnek Kullanım:" -ForegroundColor Yellow
            Write-Host "   $detailedUsage" -ForegroundColor Yellow
        }
        
        Write-Host "`nTarayıcı bağlantısı:" -ForegroundColor Green
        Write-Host $site.URL -ForegroundColor Green
    }
    else {
        Write-Host "[$selectedName] isminde bir site bulunamadı." -ForegroundColor Red
    }
}
